# goge

`goge` is a code generator for the [Fiber](https://github.com/gofiber/fiber) framework.  
It automatically creates API handlers and OpenAPI specs from annotated Go functions.

## Example

- Annotate your Fiber handler with a comment:

  ```go
  type PingParams struct {
      ID    string `gogeUrl:"id"`
      Auth  string `gogeHeader:"Authorization"`
      Query string `gogeQuery:"filter"`
  }

  //goge:api method=POST path=/ping/:id
  func Ping(c *fiber.Ctx, params *PingParams) (*PingResp, error) {
      return &PingResp{ID: params.ID}, nil
  }
  ```


- After running `go generate ./...` goge generates a handler and router automatically:

  ```go
  // Code generated by goge; DO NOT EDIT.
  package lib

  import (
    "github.com/gofiber/fiber/v2"
  )

  func PingHandler(c *fiber.Ctx) error {
    req := new(PingParams)
    if err := c.BodyParser(req); err != nil {
      return c.Status(fiber.StatusBadRequest).
        SendString("Invalid request body")
    }

    req.ID = c.Params("id")
    req.Auth = c.Get("Authorization")
    req.Query = c.Query("filter")

    res, err := Ping(c, req)
    if err != nil {
      return err
    }

    return c.JSON(res)
  }

  func GogeRouter() *fiber.App {
    app := fiber.New()
    app.Add("POST", "/ping/:id", PingHandler)
    return app
  }

  ```


- Inside your project, add the following to your `main.go`:

    ```go
    //go:generate goge

    package main

    func main() {
      app := lib.GogeRouter()
      log.Fatal(app.Listen(":8080"))
    }
    ```

## Installation

1. Make sure you have **Go 1.24+** installed.

1. This will place the `goge` binary in your `GOPATH/bin` (by default `~/go/bin`)

    ```bash
    go install github.com/xehrad/goge@latest
    ````



1. Add `$GOPATH/bin` to your PATH. If not already configured, add this to your shell config (`~/.bashrc` or `~/.zshrc`):

    ```bash
    export PATH=$PATH:$(go env GOPATH)/bin
    ```

1. Reload your shell:

    ```bash
    source ~/.bashrc
    # or
    source ~/.zshrc

    # Now you should be able to run:
    goge
    ```


## Usage

> Run `go generate ./...` and youâ€™ll get: 

  * A ready-to-use handler function at `lib/api_generated.go`
  * OpenAPI documentation with query, header, and path params at `lib/openapi.json`