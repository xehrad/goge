// Code generated by goge; DO NOT EDIT.
// More info: github.com/xehrad/goge

package {{ .Package }}

import (
    "github.com/gofiber/fiber/v2"
)

{{ range .APIs }}
func {{ .FuncName }}Handler(c *fiber.Ctx) error {
    req := new({{ .ParamsType }})
    {{- if .BodyParse }}
    if err := c.BodyParser(req); err != nil {
        return c.Status(fiber.StatusBadRequest).SendString("Invalid request body")
    }
    {{- end }}

    {{- range .Binds }}
    {{- if eq .Kind "header" }}
    req.{{ .Name }} = c.Get("{{ .Key }}")
    {{- end }}
    {{- if eq .Kind "query" }}
    req.{{ .Name }} = c.{{ .QueryFunc }}("{{ .Key }}")
    {{- end }}
    {{- if eq .Kind "url" }}
    req.{{ .Name }} = c.Params("{{ .Key }}")
    {{- end }}
    {{- end }}

    res, err := {{ .FuncName }}(c, req)
    if err != nil {
        return err
    }

    {{- if .RespIsBytes }}
    return c.Send(res)
    {{- else }}
    return c.JSON(res)
    {{- end }}
}

{{ end }}

func GogeRouter(app *fiber.App) {
    {{- range .APIs }}
    app.Add("{{ .Method }}", "{{ .Path }}", {{ .FuncName }}Handler)
    {{- end }}
}

